<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-bigdata/Spark-SQL-Basic">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">spark SQL 基本使用 | 轻舞飞扬</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://enyong.wang/docs/bigdata/Spark-SQL-Basic"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="spark SQL 基本使用 | 轻舞飞扬"><meta data-rh="true" name="description" content="创建 DataFrame"><meta data-rh="true" property="og:description" content="创建 DataFrame"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://enyong.wang/docs/bigdata/Spark-SQL-Basic"><link data-rh="true" rel="alternate" href="https://enyong.wang/docs/bigdata/Spark-SQL-Basic" hreflang="en"><link data-rh="true" rel="alternate" href="https://enyong.wang/docs/bigdata/Spark-SQL-Basic" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="轻舞飞扬 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="轻舞飞扬 Atom Feed"><link rel="stylesheet" href="/assets/css/styles.24226f32.css">
<link rel="preload" href="/assets/js/runtime~main.ddd11b3c.js" as="script">
<link rel="preload" href="/assets/js/main.bfefceb0.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">王大水的网站</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">知识库</a><a class="navbar__item navbar__link" href="/blog">博客</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/wangenyong" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">论语 · 学而</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/basics/git-command">Basics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/linux/linux-adduser">Linux</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/database/mysql-init-database">Database</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/python/python-basic">Python</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/pandas/data-structure">Pandas</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/docker/docker-install">Docker</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/bigdata/bitdata-tips">BigData</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bigdata/bitdata-tips">Big Data Tips</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bigdata/spark-RDD">spark RDD</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/bigdata/Spark-SQL-Basic">spark SQL 基本使用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bigdata/Spark-SQL-Filter">spark SQL 条件过滤</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bigdata/Spark-SQL-Case">spark SQL 多元条件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bigdata/Spark-SQL-Distintc">spark SQL 去重</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bigdata/Spark-SQL-Pivot">spark SQL Pivot</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bigdata/Spark-SQL-GroupBy">spark SQL 分组统计</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bigdata/Spark-SQL-Sort">spark SQL 排序</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bigdata/Spark-SQL-Join">spark SQL Join</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bigdata/Spark-SQL-Union">spark SQL Union</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bigdata/data-divide">元数据分层</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bigdata/hadoop-tuning">Hadoop 调优</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bigdata/hdfs-command">HDFS 常用命令</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bigdata/hive-sql-tips">Hive Sql Tips</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/front/javascript-array-method">前端</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">BigData</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">spark SQL 基本使用</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>spark SQL 基本使用</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="创建-dataframe">创建 DataFrame<a href="#创建-dataframe" class="hash-link" aria-label="Direct link to 创建 DataFrame" title="Direct link to 创建 DataFrame">​</a></h2><p>在 <strong>Spark</strong> 中，创建 <strong>DataFrame</strong> 的主要方法是 <code>createDataFrame()</code> 和 <code>toDF()</code> 。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="数据准备">数据准备<a href="#数据准备" class="hash-link" aria-label="Direct link to 数据准备" title="Direct link to 数据准备">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> sparkConf </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> </span><span class="token keyword" style="color:#66d9ef">new</span><span class="token plain"> SparkConf</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">setMaster</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;local[*]&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">setAppName</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;RDD&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> spark </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> SparkSession</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">builder</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">config</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">sparkConf</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">getOrCreate</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">import</span><span class="token plain"> </span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">spark</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">implicits</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token plain">_</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> columns </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> Seq</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;language&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token string" style="color:#a6e22e">&quot;users_count&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> data </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> Seq</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Java&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;20000&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Python&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;100000&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Scala&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;3000&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> rdd </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> spark</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">sparkContext</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">parallelize</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="通过-rdd-创建-dataframe">通过 RDD 创建 DataFrame<a href="#通过-rdd-创建-dataframe" class="hash-link" aria-label="Direct link to 通过 RDD 创建 DataFrame" title="Direct link to 通过 RDD 创建 DataFrame">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="todf">toDF()<a href="#todf" class="hash-link" aria-label="Direct link to toDF()" title="Direct link to toDF()">​</a></h4><p>通过 <code>toDF()</code> 方法，可以直接将 RDD 转换为 DataFrame，默认情况下，它会将列命名为 <strong>“<!-- -->_<!-- -->1”</strong> 和 <strong>“<!-- -->_<!-- -->2”</strong> 。（此处有两列）</p><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> dfFromRDD1 </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> rdd</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">toDF</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">dfFromRDD1</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">printSchema</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">root</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- _1: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- _2: string (nullable = true)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>此外，<strong>toDF()</strong> 还可以直接指定列名：</p><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> dfFromRDD1 </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> rdd</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">toDF</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;language&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token string" style="color:#a6e22e">&quot;users_count&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">dfFromRDD1</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">printSchema</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">root</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- language: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- users_count: string (nullable = true)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>默认情况下，列的类型为 <strong>String</strong> ；如果需要指定列的数据类型，则需要使用 <strong>Schema</strong> 。</p></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="createdataframe">createDataFrame()<a href="#createdataframe" class="hash-link" aria-label="Direct link to createDataFrame()" title="Direct link to createDataFrame()">​</a></h4><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> dfFromRDD2 </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> spark</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">createDataFrame</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">rdd</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">toDF</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">columns</span><span class="token operator" style="color:#66d9ef">:</span><span class="token plain">_</span><span class="token operator" style="color:#66d9ef">*</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>createDataFrame()</code> 方法支持 <strong>RDD<!-- -->[Row]</strong> 数据类型，在使用的时候需要定义 <strong>Schema</strong>：</p><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#66d9ef">import</span><span class="token plain"> </span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">org</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">apache</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">spark</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">sql</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">types</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain">StringType</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> StructField</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> StructType</span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">import</span><span class="token plain"> </span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">org</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">apache</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">spark</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">sql</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token plain">Row</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> schema </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> StructType</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">Array</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    StructField</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;language&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> StringType</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> nullable </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ae81ff">true</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    StructField</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;users_count&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> StringType</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> nullable </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ae81ff">true</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> rowRDD </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> rdd</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">map</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">attributes </span><span class="token keyword" style="color:#66d9ef">=&gt;</span><span class="token plain"> Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">attributes</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">_1</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> attributes</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">_2</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> dfFromRDD3 </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> spark</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">createDataFrame</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">rowRDD</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> schema</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="通过-list-和-seq-集合创建-dataframe">通过 List 和 Seq 集合创建 DataFrame<a href="#通过-list-和-seq-集合创建-dataframe" class="hash-link" aria-label="Direct link to 通过 List 和 Seq 集合创建 DataFrame" title="Direct link to 通过 List 和 Seq 集合创建 DataFrame">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="todf-1">toDF()<a href="#todf-1" class="hash-link" aria-label="Direct link to toDF()" title="Direct link to toDF()">​</a></h4><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#66d9ef">import</span><span class="token plain"> </span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">spark</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">implicits</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token plain">_</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> dfFromData1 </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">toDF</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="createdataframe-1">createDataFrame()<a href="#createdataframe-1" class="hash-link" aria-label="Direct link to createDataFrame()" title="Direct link to createDataFrame()">​</a></h4><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#8292a2;font-style:italic">//From Data (USING createDataFrame)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">var</span><span class="token plain"> dfFromData2 </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> spark</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">createDataFrame</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">toDF</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">columns</span><span class="token operator" style="color:#66d9ef">:</span><span class="token plain">_</span><span class="token operator" style="color:#66d9ef">*</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#66d9ef">import</span><span class="token plain"> </span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">scala</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">collection</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token plain">JavaConversions</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">_</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#8292a2;font-style:italic">//From Data (USING createDataFrame and Adding schema using StructType)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> schema </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> StructType</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">Array</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    StructField</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;language&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> StringType</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> nullable </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ae81ff">true</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    StructField</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;users_count&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> StringType</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> nullable </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ae81ff">true</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> rowData</span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> Seq</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Java&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;20000&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">               Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Python&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;100000&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">               Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Scala&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;3000&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">var</span><span class="token plain"> dfFromData3 </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> spark</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">createDataFrame</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">rowData</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain">schema</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="通过-csv-创建-dataframe">通过 CSV 创建 DataFrame<a href="#通过-csv-创建-dataframe" class="hash-link" aria-label="Direct link to 通过 CSV 创建 DataFrame" title="Direct link to 通过 CSV 创建 DataFrame">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> df2 </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> spark</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">read</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">csv</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;/src/resources/file.csv&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="通过-txt-创建-dataframe">通过 TXT 创建 DataFrame<a href="#通过-txt-创建-dataframe" class="hash-link" aria-label="Direct link to 通过 TXT 创建 DataFrame" title="Direct link to 通过 TXT 创建 DataFrame">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> df2 </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> spark</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">read</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">text</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;/src/resources/file.txt&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="通过-json-创建-dataframe">通过 JSON 创建 DataFrame<a href="#通过-json-创建-dataframe" class="hash-link" aria-label="Direct link to 通过 JSON 创建 DataFrame" title="Direct link to 通过 JSON 创建 DataFrame">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> df2 </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> spark</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">read</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">json</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;/src/resources/file.json&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="通过-xml-创建-dataframe">通过 XML 创建 DataFrame<a href="#通过-xml-创建-dataframe" class="hash-link" aria-label="Direct link to 通过 XML 创建 DataFrame" title="Direct link to 通过 XML 创建 DataFrame">​</a></h3><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token tag punctuation" style="color:#f8f8f2">&lt;</span><span class="token tag" style="color:#f92672">dependency</span><span class="token tag punctuation" style="color:#f8f8f2">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">     </span><span class="token tag punctuation" style="color:#f8f8f2">&lt;</span><span class="token tag" style="color:#f92672">groupId</span><span class="token tag punctuation" style="color:#f8f8f2">&gt;</span><span class="token plain">com.databricks</span><span class="token tag punctuation" style="color:#f8f8f2">&lt;/</span><span class="token tag" style="color:#f92672">groupId</span><span class="token tag punctuation" style="color:#f8f8f2">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">     </span><span class="token tag punctuation" style="color:#f8f8f2">&lt;</span><span class="token tag" style="color:#f92672">artifactId</span><span class="token tag punctuation" style="color:#f8f8f2">&gt;</span><span class="token plain">spark-xml_2.11</span><span class="token tag punctuation" style="color:#f8f8f2">&lt;/</span><span class="token tag" style="color:#f92672">artifactId</span><span class="token tag punctuation" style="color:#f8f8f2">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">     </span><span class="token tag punctuation" style="color:#f8f8f2">&lt;</span><span class="token tag" style="color:#f92672">version</span><span class="token tag punctuation" style="color:#f8f8f2">&gt;</span><span class="token plain">0.6.0</span><span class="token tag punctuation" style="color:#f8f8f2">&lt;/</span><span class="token tag" style="color:#f92672">version</span><span class="token tag punctuation" style="color:#f8f8f2">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> </span><span class="token tag punctuation" style="color:#f8f8f2">&lt;/</span><span class="token tag" style="color:#f92672">dependency</span><span class="token tag punctuation" style="color:#f8f8f2">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> df </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> spark</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">read</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">format</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;com.databricks.spark.xml&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">option</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;rowTag&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;person&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">xml</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;src/main/resources/persons.xml&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="通过-mysql-创建-dataframe">通过 MySQL 创建 DataFrame<a href="#通过-mysql-创建-dataframe" class="hash-link" aria-label="Direct link to 通过 MySQL 创建 DataFrame" title="Direct link to 通过 MySQL 创建 DataFrame">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> df_mysql </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> spark</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">read</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">format</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">“jdbc”</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">   </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">option</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">“url”</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> “jdbc</span><span class="token operator" style="color:#66d9ef">:</span><span class="token plain">mysql</span><span class="token operator" style="color:#66d9ef">:</span><span class="token operator" style="color:#66d9ef">/</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">localhost</span><span class="token operator" style="color:#66d9ef">:</span><span class="token plain">port</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">db”</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">   </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">option</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">“driver”</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> “com</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">mysql</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">jdbc</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">Driver”</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">   </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">option</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">“dbtable”</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> “tablename”</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">   </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">option</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">“user”</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> “user”</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">   </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">option</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">“password”</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> “password”</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">   </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">load</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="选择列">选择列<a href="#选择列" class="hash-link" aria-label="Direct link to 选择列" title="Direct link to 选择列">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="数据准备-1">数据准备<a href="#数据准备-1" class="hash-link" aria-label="Direct link to 数据准备" title="Direct link to 数据准备">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> spark </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> SparkSession</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">builder</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">config</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">sparkConf</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">getOrCreate</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">import</span><span class="token plain"> </span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">spark</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">implicits</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token plain">_</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> data </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> Seq</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;James&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Smith&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;USA&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;CA&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Michael&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Rose&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;USA&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;NY&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Robert&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Williams&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;USA&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;CA&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Maria&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Jones&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;USA&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;FL&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> columns </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> Seq</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;firstname&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;lastname&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;country&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;state&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> df </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">toDF</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">columns</span><span class="token operator" style="color:#66d9ef">:</span><span class="token plain"> _</span><span class="token operator" style="color:#66d9ef">*</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">show</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token boolean" style="color:#ae81ff">false</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------+--------+-------+-----+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|firstname|lastname|country|state|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------+--------+-------+-----+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|James    |Smith   |USA    |CA   |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|Michael  |Rose    |USA    |NY   |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|Robert   |Williams|USA    |CA   |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|Maria    |Jones   |USA    |FL   |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------+--------+-------+-----+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="选择单列或多列">选择单列或多列<a href="#选择单列或多列" class="hash-link" aria-label="Direct link to 选择单列或多列" title="Direct link to 选择单列或多列">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">select</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;firstname&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;lastname&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">show</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">select</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;firstname&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> df</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;lastname&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">show</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#8292a2;font-style:italic">//Using col function, use alias() to get alias name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">import</span><span class="token plain"> </span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">org</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">apache</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">spark</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">sql</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">functions</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">col</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">select</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">col</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;firstname&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">alias</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;fname&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> col</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;lastname&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">show</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------+--------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|firstname|lastname|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------+--------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|    James|   Smith|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|  Michael|    Rose|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|   Robert|Williams|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|    Maria|   Jones|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------+--------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------+--------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|firstname|lastname|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------+--------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|    James|   Smith|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|  Michael|    Rose|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|   Robert|Williams|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|    Maria|   Jones|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------+--------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+-------+--------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|  fname|lastname|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+-------+--------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|  James|   Smith|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|Michael|    Rose|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">| Robert|Williams|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|  Maria|   Jones|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+-------+--------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="选择所有列">选择所有列<a href="#选择所有列" class="hash-link" aria-label="Direct link to 选择所有列" title="Direct link to 选择所有列">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#8292a2;font-style:italic">//Show all columns from DataFrame</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">select</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;*&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">show</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> columnsAll </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">columns</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">map</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">m </span><span class="token keyword" style="color:#66d9ef">=&gt;</span><span class="token plain"> col</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">m</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">select</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">columnsAll</span><span class="token operator" style="color:#66d9ef">:</span><span class="token plain"> _</span><span class="token operator" style="color:#66d9ef">*</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">show</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">select</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">columns</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">map</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">m </span><span class="token keyword" style="color:#66d9ef">=&gt;</span><span class="token plain"> col</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">m</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token operator" style="color:#66d9ef">:</span><span class="token plain"> _</span><span class="token operator" style="color:#66d9ef">*</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">show</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------+--------+-------+-----+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|firstname|lastname|country|state|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------+--------+-------+-----+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|    James|   Smith|    USA|   CA|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|  Michael|    Rose|    USA|   NY|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|   Robert|Williams|    USA|   CA|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|    Maria|   Jones|    USA|   FL|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------+--------+-------+-----+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="根据列表选择列">根据列表选择列<a href="#根据列表选择列" class="hash-link" aria-label="Direct link to 根据列表选择列" title="Direct link to 根据列表选择列">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> listCols </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> List</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;lastname&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;country&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">select</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">listCols</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">map</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">m </span><span class="token keyword" style="color:#66d9ef">=&gt;</span><span class="token plain"> col</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">m</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token operator" style="color:#66d9ef">:</span><span class="token plain"> _</span><span class="token operator" style="color:#66d9ef">*</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">show</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">+--------+-------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|lastname|country|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+--------+-------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|   Smith|    USA|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|    Rose|    USA|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|Williams|    USA|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|   Jones|    USA|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+--------+-------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="选择前-n-列">选择前 N 列<a href="#选择前-n-列" class="hash-link" aria-label="Direct link to 选择前 N 列" title="Direct link to 选择前 N 列">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#8292a2;font-style:italic">//Select first 3 columns.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">select</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">columns</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">slice</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token number" style="color:#ae81ff">0</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token number" style="color:#ae81ff">3</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">map</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">m </span><span class="token keyword" style="color:#66d9ef">=&gt;</span><span class="token plain"> col</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">m</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token operator" style="color:#66d9ef">:</span><span class="token plain"> _</span><span class="token operator" style="color:#66d9ef">*</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">show</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------+--------+-------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|firstname|lastname|country|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------+--------+-------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|    James|   Smith|    USA|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|  Michael|    Rose|    USA|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|   Robert|Williams|    USA|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|    Maria|   Jones|    USA|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------+--------+-------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="根据位置或索引选择列">根据位置或索引选择列<a href="#根据位置或索引选择列" class="hash-link" aria-label="Direct link to 根据位置或索引选择列" title="Direct link to 根据位置或索引选择列">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#8292a2;font-style:italic">//Selects 4th column (index starts from zero)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">select</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">columns</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token number" style="color:#ae81ff">3</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">show</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#8292a2;font-style:italic">//Selects columns from index 2 to 4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">select</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">columns</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">slice</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token number" style="color:#ae81ff">2</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token number" style="color:#ae81ff">4</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">map</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">m </span><span class="token keyword" style="color:#66d9ef">=&gt;</span><span class="token plain"> col</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">m</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token operator" style="color:#66d9ef">:</span><span class="token plain"> _</span><span class="token operator" style="color:#66d9ef">*</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">show</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">+-----+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|state|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+-----+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|   CA|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|   NY|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|   CA|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|   FL|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+-----+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+-------+-----+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|country|state|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+-------+-----+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|    USA|   CA|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|    USA|   NY|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|    USA|   CA|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|    USA|   FL|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+-------+-----+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="通过正则选择列">通过正则选择列<a href="#通过正则选择列" class="hash-link" aria-label="Direct link to 通过正则选择列" title="Direct link to 通过正则选择列">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#8292a2;font-style:italic">//Select columns by regular expression</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">select</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">colRegex</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;`^.*name*`&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">show</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------+--------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|firstname|lastname|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------+--------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|    James|   Smith|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|  Michael|    Rose|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|   Robert|Williams|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|    Maria|   Jones|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------+--------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="根据-starts-或者-ends-选择列">根据 starts 或者 ends 选择列<a href="#根据-starts-或者-ends-选择列" class="hash-link" aria-label="Direct link to 根据 starts 或者 ends 选择列" title="Direct link to 根据 starts 或者 ends 选择列">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">select</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">columns</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">filter</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">f </span><span class="token keyword" style="color:#66d9ef">=&gt;</span><span class="token plain"> f</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">startsWith</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;first&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">map</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">m </span><span class="token keyword" style="color:#66d9ef">=&gt;</span><span class="token plain"> col</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">m</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token operator" style="color:#66d9ef">:</span><span class="token plain"> _</span><span class="token operator" style="color:#66d9ef">*</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">select</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">columns</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">filter</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">f </span><span class="token keyword" style="color:#66d9ef">=&gt;</span><span class="token plain"> f</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">endsWith</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;name&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">map</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">m </span><span class="token keyword" style="color:#66d9ef">=&gt;</span><span class="token plain"> col</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">m</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token operator" style="color:#66d9ef">:</span><span class="token plain"> _</span><span class="token operator" style="color:#66d9ef">*</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|firstname|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|    James|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|  Michael|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|   Robert|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|    Maria|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------+--------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|firstname|lastname|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------+--------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|    James|   Smith|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|  Michael|    Rose|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|   Robert|Williams|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|    Maria|   Jones|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------+--------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="选择多层级列">选择多层级列<a href="#选择多层级列" class="hash-link" aria-label="Direct link to 选择多层级列" title="Direct link to 选择多层级列">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#8292a2;font-style:italic">//Show Nested columns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> data2 </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> Seq</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;James&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Smith&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;OH&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;M&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Anna&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Rose&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;NY&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;F&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Julia&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Williams&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;OH&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;F&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Maria&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Anne&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Jones&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;NY&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;M&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Jen&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Mary&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Brown&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;NY&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;M&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Mike&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Mary&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Williams&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;OH&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;M&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> schema </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> </span><span class="token keyword" style="color:#66d9ef">new</span><span class="token plain"> StructType</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;name&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token keyword" style="color:#66d9ef">new</span><span class="token plain"> StructType</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;firstname&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> StringType</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;middlename&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> StringType</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;lastname&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> StringType</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;state&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> StringType</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;gender&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> StringType</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> df2 </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> spark</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">createDataFrame</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">spark</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">sparkContext</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">parallelize</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">data2</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> schema</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df2</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">printSchema</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df2</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">show</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token boolean" style="color:#ae81ff">false</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df2</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">select</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;name&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">show</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token boolean" style="color:#ae81ff">false</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df2</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">select</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;name.firstname&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;name.lastname&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">show</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token boolean" style="color:#ae81ff">false</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df2</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">select</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;name.*&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">show</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token boolean" style="color:#ae81ff">false</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">root</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- name: struct (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    |-- firstname: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    |-- middlename: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    |-- lastname: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- state: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- gender: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+----------------------+-----+------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|name                  |state|gender|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+----------------------+-----+------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[James, , Smith]      |OH   |M     |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Anna, Rose, ]        |NY   |F     |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Julia, , Williams]   |OH   |F     |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Maria, Anne, Jones]  |NY   |M     |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Jen, Mary, Brown]    |NY   |M     |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Mike, Mary, Williams]|OH   |M     |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+----------------------+-----+------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+----------------------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|name                  |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+----------------------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[James, , Smith]      |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Anna, Rose, ]        |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Julia, , Williams]   |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Maria, Anne, Jones]  |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Jen, Mary, Brown]    |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Mike, Mary, Williams]|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+----------------------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------+--------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|firstname|lastname|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------+--------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|James    |Smith   |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|Anna     |        |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|Julia    |Williams|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|Maria    |Jones   |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|Jen      |Brown   |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|Mike     |Williams|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------+--------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------+----------+--------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|firstname|middlename|lastname|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------+----------+--------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|James    |          |Smith   |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|Anna     |Rose      |        |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|Julia    |          |Williams|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|Maria    |Anne      |Jones   |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|Jen      |Mary      |Brown   |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|Mike     |Mary      |Williams|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------+----------+--------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="创建或修改列">创建或修改列<a href="#创建或修改列" class="hash-link" aria-label="Direct link to 创建或修改列" title="Direct link to 创建或修改列">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="数据准备-2">数据准备<a href="#数据准备-2" class="hash-link" aria-label="Direct link to 数据准备" title="Direct link to 数据准备">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> arrayStructureData </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> Seq</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;James &quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Smith&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;1&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;M&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token number" style="color:#ae81ff">3100</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> List</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Cricket&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Movies&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> Map</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;hair&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">-&gt;</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;black&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;eye&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">-&gt;</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;brown&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Michael &quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Rose&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;2&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;M&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token number" style="color:#ae81ff">3100</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> List</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Tennis&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> Map</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;hair&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">-&gt;</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;brown&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;eye&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">-&gt;</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;black&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Robert &quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Williams&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;3&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;M&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token number" style="color:#ae81ff">3100</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> List</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Cooking&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Football&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> Map</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;hair&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">-&gt;</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;red&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;eye&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">-&gt;</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;gray&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Maria &quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Anne&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Jones&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;4&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;M&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token number" style="color:#ae81ff">3100</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token keyword" style="color:#66d9ef">null</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> Map</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;hair&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">-&gt;</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;blond&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;eye&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">-&gt;</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;red&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Jen&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Mary&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Brown&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;5&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;M&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token number" style="color:#ae81ff">3100</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> List</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Blogging&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> Map</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;white&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">-&gt;</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;black&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;eye&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">-&gt;</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;black&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> arrayStructureSchema </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> </span><span class="token keyword" style="color:#66d9ef">new</span><span class="token plain"> StructType</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;name&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token keyword" style="color:#66d9ef">new</span><span class="token plain"> StructType</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;firstname&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> StringType</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;middlename&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> StringType</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;lastname&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> StringType</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;id&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> StringType</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;gender&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> StringType</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;salary&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> IntegerType</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Hobbies&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> ArrayType</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">StringType</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;properties&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> MapType</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">StringType</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> StringType</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> df </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> spark</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">createDataFrame</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">      spark</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">sparkContext</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">parallelize</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">arrayStructureData</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> arrayStructureSchema</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------------------+---+------+------+-------------------+------------------------------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|name                 |id |gender|salary|Hobbies            |properties                    |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------------------+---+------+------+-------------------+------------------------------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[James , , Smith]    |1  |M     |3100  |[Cricket, Movies]  |[hair -&gt; black, eye -&gt; brown] |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Michael , Rose, ]   |2  |M     |3100  |[Tennis]           |[hair -&gt; brown, eye -&gt; black] |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Robert , , Williams]|3  |M     |3100  |[Cooking, Football]|[hair -&gt; red, eye -&gt; gray]    |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Maria , Anne, Jones]|4  |M     |3100  |null               |[hair -&gt; blond, eye -&gt; red]   |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Jen, Mary, Brown]   |5  |M     |3100  |[Blogging]         |[white -&gt; black, eye -&gt; black]|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------------------+---+------+------+-------------------+------------------------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="创建新列">创建新列<a href="#创建新列" class="hash-link" aria-label="Direct link to 创建新列" title="Direct link to 创建新列">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#66d9ef">import</span><span class="token plain"> </span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">org</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">apache</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">spark</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">sql</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">functions</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">lit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">withColumn</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Country&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> lit</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;USA&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">show</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token boolean" style="color:#ae81ff">false</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#8292a2;font-style:italic">//chaining to operate on multiple columns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">withColumn</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Country&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> lit</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;USA&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">withColumn</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;anotherColumn&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain">lit</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;anotherValue&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">show</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token boolean" style="color:#ae81ff">false</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------------------+---+------+------+-------------------+------------------------------+-------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|name                 |id |gender|salary|Hobbies            |properties                    |Country|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------------------+---+------+------+-------------------+------------------------------+-------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[James , , Smith]    |1  |M     |3100  |[Cricket, Movies]  |[hair -&gt; black, eye -&gt; brown] |USA    |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Michael , Rose, ]   |2  |M     |3100  |[Tennis]           |[hair -&gt; brown, eye -&gt; black] |USA    |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Robert , , Williams]|3  |M     |3100  |[Cooking, Football]|[hair -&gt; red, eye -&gt; gray]    |USA    |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Maria , Anne, Jones]|4  |M     |3100  |null               |[hair -&gt; blond, eye -&gt; red]   |USA    |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Jen, Mary, Brown]   |5  |M     |3100  |[Blogging]         |[white -&gt; black, eye -&gt; black]|USA    |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------------------+---+------+------+-------------------+------------------------------+-------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------------------+---+------+------+-------------------+------------------------------+-------+-------------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|name                 |id |gender|salary|Hobbies            |properties                    |Country|anotherColumn|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------------------+---+------+------+-------------------+------------------------------+-------+-------------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[James , , Smith]    |1  |M     |3100  |[Cricket, Movies]  |[hair -&gt; black, eye -&gt; brown] |USA    |anotherValue |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Michael , Rose, ]   |2  |M     |3100  |[Tennis]           |[hair -&gt; brown, eye -&gt; black] |USA    |anotherValue |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Robert , , Williams]|3  |M     |3100  |[Cooking, Football]|[hair -&gt; red, eye -&gt; gray]    |USA    |anotherValue |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Maria , Anne, Jones]|4  |M     |3100  |null               |[hair -&gt; blond, eye -&gt; red]   |USA    |anotherValue |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Jen, Mary, Brown]   |5  |M     |3100  |[Blogging]         |[white -&gt; black, eye -&gt; black]|USA    |anotherValue |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------------------+---+------+------+-------------------+------------------------------+-------+-------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p><code>lit()</code> 函数用于将常量转换为 <strong>DataFrame</strong> 列的值。</p></div></div><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p><code>withColumn()</code> 只适合操作较少的列，否则会有执行效率问题。</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="修改列的值">修改列的值<a href="#修改列的值" class="hash-link" aria-label="Direct link to 修改列的值" title="Direct link to 修改列的值">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#66d9ef">import</span><span class="token plain"> </span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">org</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">apache</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">spark</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">sql</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">functions</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">col</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">withColumn</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;salary&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> col</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;salary&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">*</span><span class="token plain"> </span><span class="token number" style="color:#ae81ff">100</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">show</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token boolean" style="color:#ae81ff">false</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------------------+---+------+------+-------------------+------------------------------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|name                 |id |gender|salary|Hobbies            |properties                    |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------------------+---+------+------+-------------------+------------------------------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[James , , Smith]    |1  |M     |310000|[Cricket, Movies]  |[hair -&gt; black, eye -&gt; brown] |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Michael , Rose, ]   |2  |M     |310000|[Tennis]           |[hair -&gt; brown, eye -&gt; black] |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Robert , , Williams]|3  |M     |310000|[Cooking, Football]|[hair -&gt; red, eye -&gt; gray]    |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Maria , Anne, Jones]|4  |M     |310000|null               |[hair -&gt; blond, eye -&gt; red]   |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Jen, Mary, Brown]   |5  |M     |310000|[Blogging]         |[white -&gt; black, eye -&gt; black]|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------------------+---+------+------+-------------------+------------------------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="根据现有列增加新列">根据现有列增加新列<a href="#根据现有列增加新列" class="hash-link" aria-label="Direct link to 根据现有列增加新列" title="Direct link to 根据现有列增加新列">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#66d9ef">import</span><span class="token plain"> </span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">org</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">apache</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">spark</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">sql</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">functions</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">col</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">withColumn</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;CopiedColumn&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> col</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;salary&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">*</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">-</span><span class="token number" style="color:#ae81ff">1</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">show</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token boolean" style="color:#ae81ff">false</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------------------+---+------+------+-------------------+------------------------------+------------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|name                 |id |gender|salary|Hobbies            |properties                    |CopiedColumn|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------------------+---+------+------+-------------------+------------------------------+------------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[James , , Smith]    |1  |M     |3100  |[Cricket, Movies]  |[hair -&gt; black, eye -&gt; brown] |-3100       |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Michael , Rose, ]   |2  |M     |3100  |[Tennis]           |[hair -&gt; brown, eye -&gt; black] |-3100       |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Robert , , Williams]|3  |M     |3100  |[Cooking, Football]|[hair -&gt; red, eye -&gt; gray]    |-3100       |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Maria , Anne, Jones]|4  |M     |3100  |null               |[hair -&gt; blond, eye -&gt; red]   |-3100       |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Jen, Mary, Brown]   |5  |M     |3100  |[Blogging]         |[white -&gt; black, eye -&gt; black]|-3100       |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------------------+---+------+------+-------------------+------------------------------+------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="修改列类型">修改列类型<a href="#修改列类型" class="hash-link" aria-label="Direct link to 修改列类型" title="Direct link to 修改列类型">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#66d9ef">import</span><span class="token plain"> </span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">org</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">apache</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">spark</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">sql</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">functions</span><span class="token namespace punctuation" style="color:#f8f8f2;opacity:0.7">.</span><span class="token namespace" style="color:rgb(178, 204, 214);opacity:0.7">col</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">var</span><span class="token plain"> df1 </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">withColumn</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;salary&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> col</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;salary&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">cast</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Integer&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df1</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">printSchema</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">root</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- name: struct (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    |-- firstname: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    |-- middlename: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    |-- lastname: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- id: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- gender: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- salary: integer (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- Hobbies: array (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    |-- element: string (containsNull = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- properties: map (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    |-- key: string</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    |-- value: string (valueContainsNull = true)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="修改多列">修改多列<a href="#修改多列" class="hash-link" aria-label="Direct link to 修改多列" title="Direct link to 修改多列">​</a></h3><p>在 <strong>Spark DataFrame</strong> 中，涉及修改多列的操作一般不使用 <code>withColumn()</code> 方法，推荐创建一个临时视图，然后使用 <code>Select()</code> 方法对 <strong>DataFrame</strong> 进行修改。</p><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">createOrReplaceTempView</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;PERSON&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">spark</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">sql</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#a6e22e">&quot;&quot;&quot;SELECT salary*100 as salary, </span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token triple-quoted-string string" style="color:#a6e22e">      |        salary*-1 as CopiedColumn,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token triple-quoted-string string" style="color:#a6e22e">      |            &#x27;USA&#x27; as country FROM PERSON&quot;&quot;&quot;</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">stripMargin</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">show</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">+------+------------+-------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|salary|CopiedColumn|country|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+------+------------+-------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|310000|       -3100|    USA|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|310000|       -3100|    USA|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|310000|       -3100|    USA|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|310000|       -3100|    USA|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|310000|       -3100|    USA|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+------+------------+-------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="列重命名">列重命名<a href="#列重命名" class="hash-link" aria-label="Direct link to 列重命名" title="Direct link to 列重命名">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">withColumnRenamed</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;gender&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;sex&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">show</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token boolean" style="color:#ae81ff">false</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------------------+---+---+------+-------------------+------------------------------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|name                 |id |sex|salary|Hobbies            |properties                    |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------------------+---+---+------+-------------------+------------------------------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[James , , Smith]    |1  |M  |3100  |[Cricket, Movies]  |[hair -&gt; black, eye -&gt; brown] |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Michael , Rose, ]   |2  |M  |3100  |[Tennis]           |[hair -&gt; brown, eye -&gt; black] |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Robert , , Williams]|3  |M  |3100  |[Cooking, Football]|[hair -&gt; red, eye -&gt; gray]    |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Maria , Anne, Jones]|4  |M  |3100  |null               |[hair -&gt; blond, eye -&gt; red]   |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|[Jen, Mary, Brown]   |5  |M  |3100  |[Blogging]         |[white -&gt; black, eye -&gt; black]|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+---------------------+---+---+------+-------------------+------------------------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="删除列">删除列<a href="#删除列" class="hash-link" aria-label="Direct link to 删除列" title="Direct link to 删除列">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">drop</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;CopiedColumn&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="拆分列为多列">拆分列为多列<a href="#拆分列为多列" class="hash-link" aria-label="Direct link to 拆分列为多列" title="Direct link to 拆分列为多列">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> columns </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> Seq</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;name&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;address&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> data </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> Seq</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Robert, Smith&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;1 Main st, Newark, NJ, 92537&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Maria, Garcia&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;3456 Walnut st, Newark, NJ, 94732&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">var</span><span class="token plain"> dfFromData </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> spark</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">createDataFrame</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">toDF</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">columns</span><span class="token operator" style="color:#66d9ef">:</span><span class="token plain"> _</span><span class="token operator" style="color:#66d9ef">*</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">dfFromData</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">printSchema</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> newDF </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> dfFromData</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">map</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">f </span><span class="token keyword" style="color:#66d9ef">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> nameSplit </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> f</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">getAs</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token builtin" style="color:#e6db74">String</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token number" style="color:#ae81ff">0</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;,&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> addSplit </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> f</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">getAs</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token builtin" style="color:#e6db74">String</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token number" style="color:#ae81ff">1</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;,&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">nameSplit</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token number" style="color:#ae81ff">0</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> nameSplit</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token number" style="color:#ae81ff">1</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> addSplit</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token number" style="color:#ae81ff">0</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> addSplit</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token number" style="color:#ae81ff">1</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> addSplit</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token number" style="color:#ae81ff">2</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> addSplit</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token number" style="color:#ae81ff">3</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> finalDF </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> newDF</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">toDF</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;First Name&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Last Name&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token string" style="color:#a6e22e">&quot;Address Line1&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;City&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;State&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;zipCode&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">finalDF</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">printSchema</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">finalDF</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">show</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token boolean" style="color:#ae81ff">false</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">root</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- name: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- address: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">root</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- First Name: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- Last Name: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- Address Line1: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- City: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- State: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- zipCode: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+----------+---------+--------------+-------+-----+-------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|First Name|Last Name|Address Line1 |City   |State|zipCode|</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+----------+---------+--------------+-------+-----+-------+</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|Robert    | Smith   |1 Main st     | Newark| NJ  | 92537 |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">|Maria     | Garcia  |3456 Walnut st| Newark| NJ  | 94732 |</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">+----------+---------+--------------+-------+-----+-------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="列重命名-1">列重命名<a href="#列重命名-1" class="hash-link" aria-label="Direct link to 列重命名" title="Direct link to 列重命名">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="数据准备-3">数据准备<a href="#数据准备-3" class="hash-link" aria-label="Direct link to 数据准备" title="Direct link to 数据准备">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> data </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> Seq</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;James &quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Smith&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;36636&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;M&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token number" style="color:#ae81ff">3000</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Michael &quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Rose&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;40288&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;M&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token number" style="color:#ae81ff">4000</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Robert &quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Williams&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;42114&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;M&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token number" style="color:#ae81ff">4000</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Maria &quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Anne&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Jones&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;39192&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;F&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token number" style="color:#ae81ff">4000</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Jen&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Mary&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Brown&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;F&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">-</span><span class="token number" style="color:#ae81ff">1</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> schema </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> </span><span class="token keyword" style="color:#66d9ef">new</span><span class="token plain"> StructType</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;name&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token keyword" style="color:#66d9ef">new</span><span class="token plain"> StructType</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;firstname&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> StringType</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;middlename&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> StringType</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;lastname&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> StringType</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;dob&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> StringType</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;gender&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> StringType</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;salary&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> IntegerType</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> df </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> spark</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">createDataFrame</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">spark</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">sparkContext</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">parallelize</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> schema</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">printSchema</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">root</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- name: struct (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    |-- firstname: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    |-- middlename: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    |-- lastname: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- dob: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- gender: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- salary: integer (nullable = true)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="基本使用">基本使用<a href="#基本使用" class="hash-link" aria-label="Direct link to 基本使用" title="Direct link to 基本使用">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">withColumnRenamed</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;dob&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;DateOfBirth&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">printSchema</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">root</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- name: struct (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    |-- firstname: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    |-- middlename: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    |-- lastname: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- DateOfBirth: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- gender: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- salary: integer (nullable = true)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="重命名多列">重命名多列<a href="#重命名多列" class="hash-link" aria-label="Direct link to 重命名多列" title="Direct link to 重命名多列">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> df2 </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">withColumnRenamed</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;dob&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;DateOfBirth&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">withColumnRenamed</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;salary&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;salary_amount&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df2</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">printSchema</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">root</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- name: struct (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    |-- firstname: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    |-- middlename: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    |-- lastname: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- DateOfBirth: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- gender: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- salary_amount: integer (nullable = true)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="使用-spark-structtype-重命名">使用 Spark StructType 重命名<a href="#使用-spark-structtype-重命名" class="hash-link" aria-label="Direct link to 使用 Spark StructType 重命名" title="Direct link to 使用 Spark StructType 重命名">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> schema2 </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> </span><span class="token keyword" style="color:#66d9ef">new</span><span class="token plain"> StructType</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;fname&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> StringType</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;middlename&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> StringType</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;lname&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> StringType</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">select</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">col</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;name&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">cast</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">schema2</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    col</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;dob&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    col</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;gender&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    col</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;salary&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">printSchema</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">root</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- name: struct (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    |-- fname: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    |-- middlename: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    |-- lname: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- dob: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- gender: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- salary: integer (nullable = true)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="使用-select-重命名">使用 Select 重命名<a href="#使用-select-重命名" class="hash-link" aria-label="Direct link to 使用 Select 重命名" title="Direct link to 使用 Select 重命名">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">select</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">col</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;name.firstname&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">as</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;fname&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    col</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;name.middlename&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">as</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;mname&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    col</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;name.lastname&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">as</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;lname&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    col</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;dob&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> col</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;gender&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> col</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;salary&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">printSchema</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">root</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- fname: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- mname: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- lname: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- dob: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- gender: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- salary: integer (nullable = true)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="使用-withcolumn-重命名">使用 withColumn 重命名<a href="#使用-withcolumn-重命名" class="hash-link" aria-label="Direct link to 使用 withColumn 重命名" title="Direct link to 使用 withColumn 重命名">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> df4 </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">withColumn</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;fname&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> col</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;name.firstname&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">withColumn</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;mname&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> col</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;name.middlename&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">withColumn</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;lname&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> col</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;name.lastname&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">drop</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;name&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df4</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">printSchema</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">root</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- dob: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- gender: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- salary: integer (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- fname: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- mname: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- lname: string (nullable = true)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="使用-col-批量修改列名">使用 col() 批量修改列名<a href="#使用-col-批量修改列名" class="hash-link" aria-label="Direct link to 使用 col() 批量修改列名" title="Direct link to 使用 col() 批量修改列名">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> old_columns </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> Seq</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;dob&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token string" style="color:#a6e22e">&quot;gender&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token string" style="color:#a6e22e">&quot;salary&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token string" style="color:#a6e22e">&quot;fname&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token string" style="color:#a6e22e">&quot;mname&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token string" style="color:#a6e22e">&quot;lname&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> new_columns </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> Seq</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;DateOfBirth&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token string" style="color:#a6e22e">&quot;Sex&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token string" style="color:#a6e22e">&quot;salary&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token string" style="color:#a6e22e">&quot;firstName&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token string" style="color:#a6e22e">&quot;middleName&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token string" style="color:#a6e22e">&quot;lastName&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> columnsList </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> old_columns</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">zip</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">new_columns</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">map</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">f</span><span class="token keyword" style="color:#66d9ef">=&gt;</span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain">col</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">f</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">_1</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">as</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">f</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">_2</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> df5 </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> df4</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">select</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">columnsList</span><span class="token operator" style="color:#66d9ef">:</span><span class="token plain">_</span><span class="token operator" style="color:#66d9ef">*</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df5</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">printSchema</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">root</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- DateOfBirth: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- Sex: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- salary: integer (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- firstName: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- middleName: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- lastName: string (nullable = true)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="删除列-1">删除列<a href="#删除列-1" class="hash-link" aria-label="Direct link to 删除列" title="Direct link to 删除列">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="数据准备-4">数据准备<a href="#数据准备-4" class="hash-link" aria-label="Direct link to 数据准备" title="Direct link to 数据准备">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> structureData </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> Seq</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;James&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Smith&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;36636&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;NewYork&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token number" style="color:#ae81ff">3100</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Michael&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Rose&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;40288&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;California&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token number" style="color:#ae81ff">4300</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Robert&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Williams&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;42114&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Florida&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token number" style="color:#ae81ff">1400</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Maria&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Anne&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Jones&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;39192&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Florida&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token number" style="color:#ae81ff">5500</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Row</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;Jen&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Mary&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;Brown&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;34561&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;NewYork&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token number" style="color:#ae81ff">3000</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> structureSchema </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> </span><span class="token keyword" style="color:#66d9ef">new</span><span class="token plain"> StructType</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;firstname&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> StringType</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;middlename&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> StringType</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;lastname&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> StringType</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;id&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> StringType</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;location&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> StringType</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;salary&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> IntegerType</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> df </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> spark</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">createDataFrame</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    spark</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">sparkContext</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">parallelize</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">structureData</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> structureSchema</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">printSchema</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">root</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- firstname: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- middlename: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- lastname: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- id: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- location: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- salary: integer (nullable = true)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="删除一列">删除一列<a href="#删除一列" class="hash-link" aria-label="Direct link to 删除一列" title="Direct link to 删除一列">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> df2 </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">drop</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;firstname&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token comment" style="color:#8292a2;font-style:italic">//First signature</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df2</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">printSchema</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">drop</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;firstname&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">printSchema</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#8292a2;font-style:italic">//import org.apache.spark.sql.functions.col is required</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">drop</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">col</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;firstname&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">printSchema</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token comment" style="color:#8292a2;font-style:italic">//Third signature</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">root</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- middlename: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- lastname: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- id: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- location: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- salary: integer (nullable = true)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="删除多列">删除多列<a href="#删除多列" class="hash-link" aria-label="Direct link to 删除多列" title="Direct link to 删除多列">​</a></h3><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#8292a2;font-style:italic">//Refering more than one column</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">drop</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;firstname&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;middlename&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;lastname&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">printSchema</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#8292a2;font-style:italic">// using array/sequence of columns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#66d9ef">val</span><span class="token plain"> cols </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> Seq</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#a6e22e">&quot;firstname&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;middlename&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;lastname&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">drop</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">cols</span><span class="token operator" style="color:#66d9ef">:</span><span class="token plain"> _</span><span class="token operator" style="color:#66d9ef">*</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">printSchema</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">root</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- id: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- location: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |-- salary: integer (nullable = true)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/main/website/docs/bigdata/spark-SQL-Basic.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/bigdata/spark-RDD"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">spark RDD</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/bigdata/Spark-SQL-Filter"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">spark SQL 条件过滤</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#创建-dataframe" class="table-of-contents__link toc-highlight">创建 DataFrame</a><ul><li><a href="#数据准备" class="table-of-contents__link toc-highlight">数据准备</a></li><li><a href="#通过-rdd-创建-dataframe" class="table-of-contents__link toc-highlight">通过 RDD 创建 DataFrame</a></li><li><a href="#通过-list-和-seq-集合创建-dataframe" class="table-of-contents__link toc-highlight">通过 List 和 Seq 集合创建 DataFrame</a></li><li><a href="#通过-csv-创建-dataframe" class="table-of-contents__link toc-highlight">通过 CSV 创建 DataFrame</a></li><li><a href="#通过-txt-创建-dataframe" class="table-of-contents__link toc-highlight">通过 TXT 创建 DataFrame</a></li><li><a href="#通过-json-创建-dataframe" class="table-of-contents__link toc-highlight">通过 JSON 创建 DataFrame</a></li><li><a href="#通过-xml-创建-dataframe" class="table-of-contents__link toc-highlight">通过 XML 创建 DataFrame</a></li><li><a href="#通过-mysql-创建-dataframe" class="table-of-contents__link toc-highlight">通过 MySQL 创建 DataFrame</a></li></ul></li><li><a href="#选择列" class="table-of-contents__link toc-highlight">选择列</a><ul><li><a href="#数据准备-1" class="table-of-contents__link toc-highlight">数据准备</a></li><li><a href="#选择单列或多列" class="table-of-contents__link toc-highlight">选择单列或多列</a></li><li><a href="#选择所有列" class="table-of-contents__link toc-highlight">选择所有列</a></li><li><a href="#根据列表选择列" class="table-of-contents__link toc-highlight">根据列表选择列</a></li><li><a href="#选择前-n-列" class="table-of-contents__link toc-highlight">选择前 N 列</a></li><li><a href="#根据位置或索引选择列" class="table-of-contents__link toc-highlight">根据位置或索引选择列</a></li><li><a href="#通过正则选择列" class="table-of-contents__link toc-highlight">通过正则选择列</a></li><li><a href="#根据-starts-或者-ends-选择列" class="table-of-contents__link toc-highlight">根据 starts 或者 ends 选择列</a></li><li><a href="#选择多层级列" class="table-of-contents__link toc-highlight">选择多层级列</a></li></ul></li><li><a href="#创建或修改列" class="table-of-contents__link toc-highlight">创建或修改列</a><ul><li><a href="#数据准备-2" class="table-of-contents__link toc-highlight">数据准备</a></li><li><a href="#创建新列" class="table-of-contents__link toc-highlight">创建新列</a></li><li><a href="#修改列的值" class="table-of-contents__link toc-highlight">修改列的值</a></li><li><a href="#根据现有列增加新列" class="table-of-contents__link toc-highlight">根据现有列增加新列</a></li><li><a href="#修改列类型" class="table-of-contents__link toc-highlight">修改列类型</a></li><li><a href="#修改多列" class="table-of-contents__link toc-highlight">修改多列</a></li><li><a href="#列重命名" class="table-of-contents__link toc-highlight">列重命名</a></li><li><a href="#删除列" class="table-of-contents__link toc-highlight">删除列</a></li><li><a href="#拆分列为多列" class="table-of-contents__link toc-highlight">拆分列为多列</a></li></ul></li><li><a href="#列重命名-1" class="table-of-contents__link toc-highlight">列重命名</a><ul><li><a href="#数据准备-3" class="table-of-contents__link toc-highlight">数据准备</a></li><li><a href="#基本使用" class="table-of-contents__link toc-highlight">基本使用</a></li><li><a href="#重命名多列" class="table-of-contents__link toc-highlight">重命名多列</a></li><li><a href="#使用-spark-structtype-重命名" class="table-of-contents__link toc-highlight">使用 Spark StructType 重命名</a></li><li><a href="#使用-select-重命名" class="table-of-contents__link toc-highlight">使用 Select 重命名</a></li><li><a href="#使用-withcolumn-重命名" class="table-of-contents__link toc-highlight">使用 withColumn 重命名</a></li><li><a href="#使用-col-批量修改列名" class="table-of-contents__link toc-highlight">使用 col() 批量修改列名</a></li></ul></li><li><a href="#删除列-1" class="table-of-contents__link toc-highlight">删除列</a><ul><li><a href="#数据准备-4" class="table-of-contents__link toc-highlight">数据准备</a></li><li><a href="#删除一列" class="table-of-contents__link toc-highlight">删除一列</a></li><li><a href="#删除多列" class="table-of-contents__link toc-highlight">删除多列</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">知识库</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">博客</a></li><li class="footer__item"><a href="https://github.com/wangenyong" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Docs, Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.ddd11b3c.js"></script>
<script src="/assets/js/main.bfefceb0.js"></script>
</body>
</html>