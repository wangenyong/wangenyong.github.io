"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[1659],{3905:(e,a,n)=>{n.d(a,{Zo:()=>c,kt:()=>f});var t=n(7294);function r(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}function l(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,t)}return n}function s(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?l(Object(n),!0).forEach((function(a){r(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}function i(e,a){if(null==e)return{};var n,t,r=function(e,a){if(null==e)return{};var n,t,r={},l=Object.keys(e);for(t=0;t<l.length;t++)n=l[t],a.indexOf(n)>=0||(r[n]=e[n]);return r}(e,a);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(t=0;t<l.length;t++)n=l[t],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var o=t.createContext({}),p=function(e){var a=t.useContext(o),n=a;return e&&(n="function"==typeof e?e(a):s(s({},a),e)),n},c=function(e){var a=p(e.components);return t.createElement(o.Provider,{value:a},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var a=e.children;return t.createElement(t.Fragment,{},a)}},m=t.forwardRef((function(e,a){var n=e.components,r=e.mdxType,l=e.originalType,o=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),d=p(n),m=r,f=d["".concat(o,".").concat(m)]||d[m]||u[m]||l;return n?t.createElement(f,s(s({ref:a},c),{},{components:n})):t.createElement(f,s({ref:a},c))}));function f(e,a){var n=arguments,r=a&&a.mdxType;if("string"==typeof e||r){var l=n.length,s=new Array(l);s[0]=m;var i={};for(var o in a)hasOwnProperty.call(a,o)&&(i[o]=a[o]);i.originalType=e,i[d]="string"==typeof e?e:r,s[1]=i;for(var p=2;p<l;p++)s[p]=n[p];return t.createElement.apply(null,s)}return t.createElement.apply(null,n)}m.displayName="MDXCreateElement"},8602:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>o,contentTitle:()=>s,default:()=>u,frontMatter:()=>l,metadata:()=>i,toc:()=>p});var t=n(7462),r=(n(7294),n(3905));const l={sidebar_position:4,id:"Spark-SQL-Filter",title:"spark SQL \u6761\u4ef6\u8fc7\u6ee4"},s=void 0,i={unversionedId:"bigdata/Spark-SQL-Filter",id:"bigdata/Spark-SQL-Filter",title:"spark SQL \u6761\u4ef6\u8fc7\u6ee4",description:"\u6570\u636e\u51c6\u5907",source:"@site/docs/bigdata/spark-SQL-Filter.md",sourceDirName:"bigdata",slug:"/bigdata/Spark-SQL-Filter",permalink:"/docs/bigdata/Spark-SQL-Filter",draft:!1,editUrl:"https://github.com/facebook/docusaurus/edit/main/website/docs/bigdata/spark-SQL-Filter.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4,id:"Spark-SQL-Filter",title:"spark SQL \u6761\u4ef6\u8fc7\u6ee4"},sidebar:"tutorialSidebar",previous:{title:"spark SQL \u57fa\u672c\u4f7f\u7528",permalink:"/docs/bigdata/Spark-SQL-Basic"},next:{title:"spark SQL \u591a\u5143\u6761\u4ef6",permalink:"/docs/bigdata/Spark-SQL-Case"}},o={},p=[{value:"\u6570\u636e\u51c6\u5907",id:"\u6570\u636e\u51c6\u5907",level:2},{value:"\u5355\u4e2a\u6761\u4ef6\u8fc7\u6ee4",id:"\u5355\u4e2a\u6761\u4ef6\u8fc7\u6ee4",level:2},{value:"\u4f7f\u7528 SQL \u8868\u8fbe\u5f0f\u8fc7\u6ee4",id:"\u4f7f\u7528-sql-\u8868\u8fbe\u5f0f\u8fc7\u6ee4",level:2},{value:"\u4f7f\u7528\u591a\u4e2a\u6761\u4ef6\u8fdb\u884c\u8fc7\u6ee4",id:"\u4f7f\u7528\u591a\u4e2a\u6761\u4ef6\u8fdb\u884c\u8fc7\u6ee4",level:2},{value:"\u8fc7\u6ee4\u6570\u7ec4\u5217",id:"\u8fc7\u6ee4\u6570\u7ec4\u5217",level:2},{value:"\u6839\u636e\u5217\u5b50\u96c6\u8fdb\u884c\u8fc7\u6ee4",id:"\u6839\u636e\u5217\u5b50\u96c6\u8fdb\u884c\u8fc7\u6ee4",level:2}],c={toc:p},d="wrapper";function u(e){let{components:a,...n}=e;return(0,r.kt)(d,(0,t.Z)({},c,n,{components:a,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"\u6570\u636e\u51c6\u5907"},"\u6570\u636e\u51c6\u5907"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-scala"},'val arrayStructureData = Seq(\n    Row(Row("James", "", "Smith"), List("Java", "Scala", "C++"), "OH", "M"),\n    Row(Row("Anna", "Rose", ""), List("Spark", "Java", "C++"), "NY", "F"),\n    Row(Row("Julia", "", "Williams"), List("CSharp", "VB"), "OH", "F"),\n    Row(Row("Maria", "Anne", "Jones"), List("CSharp", "VB"), "NY", "M"),\n    Row(Row("Jen", "Mary", "Brown"), List("CSharp", "VB"), "NY", "M"),\n    Row(Row("Mike", "Mary", "Williams"), List("Python", "VB"), "OH", "M")\n)\n\nval arrayStructureSchema = new StructType()\n    .add("name", new StructType()\n        .add("firstname", StringType)\n        .add("middlename", StringType)\n        .add("lastname", StringType))\n    .add("languages", ArrayType(StringType))\n    .add("state", StringType)\n    .add("gender", StringType)\n\nval df = spark.createDataFrame(\n    spark.sparkContext.parallelize(arrayStructureData), arrayStructureSchema)\ndf.printSchema()\ndf.show()\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"root\n |-- name: struct (nullable = true)\n |    |-- firstname: string (nullable = true)\n |    |-- middlename: string (nullable = true)\n |    |-- lastname: string (nullable = true)\n |-- languages: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- state: string (nullable = true)\n |-- gender: string (nullable = true)\n\n+--------------------+------------------+-----+------+\n|                name|         languages|state|gender|\n+--------------------+------------------+-----+------+\n|    [James, , Smith]|[Java, Scala, C++]|   OH|     M|\n|      [Anna, Rose, ]|[Spark, Java, C++]|   NY|     F|\n| [Julia, , Williams]|      [CSharp, VB]|   OH|     F|\n|[Maria, Anne, Jones]|      [CSharp, VB]|   NY|     M|\n|  [Jen, Mary, Brown]|      [CSharp, VB]|   NY|     M|\n|[Mike, Mary, Will...|      [Python, VB]|   OH|     M|\n+--------------------+------------------+-----+------+\n")),(0,r.kt)("h2",{id:"\u5355\u4e2a\u6761\u4ef6\u8fc7\u6ee4"},"\u5355\u4e2a\u6761\u4ef6\u8fc7\u6ee4"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-scala"},'df.filter(df("state") === "OH").show(false)\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"+----------------------+------------------+-----+------+\n|name                  |languages         |state|gender|\n+----------------------+------------------+-----+------+\n|[James, , Smith]      |[Java, Scala, C++]|OH   |M     |\n|[Julia, , Williams]   |[CSharp, VB]      |OH   |F     |\n|[Mike, Mary, Williams]|[Python, VB]      |OH   |M     |\n+----------------------+------------------+-----+------+\n")),(0,r.kt)("p",null,"\u4ee5\u4e0b\u5199\u6cd5\u5747\u80fd\u5f97\u5230\u540c\u6837\u7684\u7ed3\u679c\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-scala"},'df.filter(\'state === "OH").show(false)\ndf.filter($state === "OH").show(false)\ndf.filter(col("state") === "OH").show(false)\ndf.where(df("state") === "OH").show(false)\ndf.where(\'state === "OH").show(false)\ndf.where($state === "OH").show(false)\ndf.where(col("state") === "OH").show(false)\n')),(0,r.kt)("h2",{id:"\u4f7f\u7528-sql-\u8868\u8fbe\u5f0f\u8fc7\u6ee4"},"\u4f7f\u7528 SQL \u8868\u8fbe\u5f0f\u8fc7\u6ee4"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-scala"},"df.filter(\"gender == 'M'\").show(false)\ndf.where(\"gender == 'M'\").show(false)\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"+----------------------+------------------+-----+------+\n|name                  |languages         |state|gender|\n+----------------------+------------------+-----+------+\n|[James, , Smith]      |[Java, Scala, C++]|OH   |M     |\n|[Maria, Anne, Jones]  |[CSharp, VB]      |NY   |M     |\n|[Jen, Mary, Brown]    |[CSharp, VB]      |NY   |M     |\n|[Mike, Mary, Williams]|[Python, VB]      |OH   |M     |\n+----------------------+------------------+-----+------+\n")),(0,r.kt)("h2",{id:"\u4f7f\u7528\u591a\u4e2a\u6761\u4ef6\u8fdb\u884c\u8fc7\u6ee4"},"\u4f7f\u7528\u591a\u4e2a\u6761\u4ef6\u8fdb\u884c\u8fc7\u6ee4"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-scala"},'df.filter(df("state") === "OH" && df("gender") === "M").show(false)\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"+----------------------+------------------+-----+------+\n|name                  |languages         |state|gender|\n+----------------------+------------------+-----+------+\n|[James, , Smith]      |[Java, Scala, C++]|OH   |M     |\n|[Mike, Mary, Williams]|[Python, VB]      |OH   |M     |\n+----------------------+------------------+-----+------+\n")),(0,r.kt)("h2",{id:"\u8fc7\u6ee4\u6570\u7ec4\u5217"},"\u8fc7\u6ee4\u6570\u7ec4\u5217"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-scala"},'import org.apache.spark.sql.functions.array_contains\ndf.filter(array_contains(df("languages"), "Java")).show(false)\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"+----------------+------------------+-----+------+\n|name            |languages         |state|gender|\n+----------------+------------------+-----+------+\n|[James, , Smith]|[Java, Scala, C++]|OH   |M     |\n|[Anna, Rose, ]  |[Spark, Java, C++]|NY   |F     |\n+----------------+------------------+-----+------+\n")),(0,r.kt)("h2",{id:"\u6839\u636e\u5217\u5b50\u96c6\u8fdb\u884c\u8fc7\u6ee4"},"\u6839\u636e\u5217\u5b50\u96c6\u8fdb\u884c\u8fc7\u6ee4"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-scala"},'df.filter(df("name.lastname") === "Williams").show(false)\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"+----------------------+------------+-----+------+\n|name                  |languages   |state|gender|\n+----------------------+------------+-----+------+\n|[Julia, , Williams]   |[CSharp, VB]|OH   |F     |\n|[Mike, Mary, Williams]|[Python, VB]|OH   |M     |\n+----------------------+------------+-----+------+\n")))}u.isMDXComponent=!0}}]);